// SPDX-License-Identifier: MIT
pragma solidity ^0.8.20;
interface IERC20 { function transferFrom(address from, address to, uint256 amount) external returns (bool); function transfer(address to, uint256 amount) external returns (bool); }
contract DonationEscrowV2 { address public owner; address public platform; uint256 public platformFeeBps; bool public paused; event Donated(address indexed donor, address indexed campaignOwner, address token, uint256 amount, uint256 fee); modifier onlyOwner(){ require(msg.sender==owner,'owner'); _; } modifier notPaused(){ require(!paused,'paused'); _; } constructor(address _platform, uint256 _platformFeeBps){ owner = msg.sender; platform = _platform; platformFeeBps = _platformFeeBps; paused = false; } function donateERC20(address token, address campaignOwner, uint256 amount) external notPaused { require(amount>0,'amount'); IERC20(token).transferFrom(msg.sender,address(this),amount); uint256 fee = (amount*platformFeeBps)/10000; uint256 remainder = amount - fee; IERC20(token).transfer(platform, fee); IERC20(token).transfer(campaignOwner, remainder); emit Donated(msg.sender, campaignOwner, token, amount, fee); } function setPlatform(address _platform) external onlyOwner { platform = _platform; } function setFeeBps(uint256 _bps) external onlyOwner { require(_bps <= 1000, 'max 10%'); platformFeeBps = _bps; } function pause() external onlyOwner { paused = true; } function unpause() external onlyOwner { paused = false; } }
